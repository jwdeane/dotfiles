#!/usr/bin/env -S uv --quiet run --script
# /// script
# requires-python = ">=3.12"
# dependencies = ["cloudflare>=3.0.0"]
# ///
"""Look up Cloudflare account ID by zone name."""

import sys
from cloudflare import Cloudflare


def main():
    if len(sys.argv) != 2 or sys.argv[1] in ("-h", "--help"):
        print("Usage: accid <zone_name>", file=sys.stderr)
        sys.exit(1)

    zone_name = sys.argv[1]

    try:
        client = Cloudflare()
        zones = client.zones.list(name=zone_name, status="active")

        if not zones.result:
            print(f"Error: zone '{zone_name}' not found", file=sys.stderr)
            sys.exit(1)

        account_id = zones.result[0].account.id
        if not account_id:
            print("Error: no account_id in response", file=sys.stderr)
            sys.exit(1)

        print(account_id)

    except Exception as e:
        print(f"Error: {e}", file=sys.stderr)
        sys.exit(1)


if __name__ == "__main__":
    main()
